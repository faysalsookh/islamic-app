import 'dart:convert';
import 'package:flutter/foundation.dart';
import 'package:http/http.dart' as http;

/// Service to translate English Quranic words to Bengali
class BengaliTranslationService {
  // Singleton
  static final BengaliTranslationService _instance = BengaliTranslationService._internal();
  factory BengaliTranslationService() => _instance;
  BengaliTranslationService._internal();

  // Cache for translations
  final Map<String, String> _translationCache = {};

  /// Comprehensive English to Bengali dictionary for Quranic words
  static const Map<String, String> _dictionary = {
    // === ALLAH AND DIVINE ATTRIBUTES ===
    'Allah': 'আল্লাহ',
    '(of) Allah': 'আল্লাহর',
    'of Allah': 'আল্লাহর',
    'the Most Gracious': 'পরম করুণাময়',
    'Most Gracious': 'পরম করুণাময়',
    'the Most Merciful': 'অতি দয়ালু',
    'Most Merciful': 'অতি দয়ালু',
    'the Merciful': 'দয়ালু',
    'Merciful': 'দয়ালু',
    'In (the) name': 'নামে',
    'In the name': 'নামে',
    'name': 'নাম',
    'Lord': 'রব/প্রভু',
    '(the) Lord': 'রব',
    'of the Lord': 'রবের',
    'your Lord': 'তোমার রব',
    'their Lord': 'তাদের রব',
    'my Lord': 'আমার রব',
    'our Lord': 'আমাদের রব',
    '(of) the worlds': 'বিশ্বজগতের',
    'the worlds': 'বিশ্বজগত',
    'worlds': 'জগতসমূহ',

    // === PRAISE AND WORSHIP ===
    'All praises': 'সমস্ত প্রশংসা',
    'All praise': 'সমস্ত প্রশংসা',
    'Praise': 'প্রশংসা',
    'praise': 'প্রশংসা',
    'be': 'হোক',
    'is': 'হয়',
    'to': 'জন্য',
    'for': 'জন্য',
    'worship': 'ইবাদত',
    'we worship': 'আমরা ইবাদত করি',
    'You alone': 'শুধুমাত্র আপনাকেই',
    'You Alone': 'শুধুমাত্র আপনাকেই',
    'alone': 'একমাত্র',
    'Alone': 'একমাত্র',
    'only': 'শুধুমাত্র',
    'Only': 'শুধুমাত্র',
    'ask for help': 'সাহায্য চাই',
    'we ask for help': 'আমরা সাহায্য চাই',
    'seek help': 'সাহায্য প্রার্থনা করি',
    'we seek help': 'আমরা সাহায্য প্রার্থনা করি',

    // === GUIDANCE AND PATH ===
    'Guide': 'পথ দেখান',
    'guide': 'পথ দেখান',
    'Guide us': 'আমাদের পথ দেখান',
    'the path': 'পথ',
    'path': 'পথ',
    'way': 'পথ',
    'the way': 'পথ',
    'the straight': 'সরল',
    'straight': 'সরল/সঠিক',
    'Straight': 'সরল',

    // === BLESSINGS AND FAVORS ===
    'those who': 'যাদের',
    'Those who': 'যারা',
    'bestowed favor': 'অনুগ্রহ করেছেন',
    'You have bestowed': 'আপনি অনুগ্রহ করেছেন',
    'favor': 'অনুগ্রহ',
    'favors': 'অনুগ্রহসমূহ',
    'upon': 'উপর',
    'upon them': 'তাদের উপর',
    'on them': 'তাদের উপর',
    'them': 'তাদের',

    // === ANGER AND GOING ASTRAY ===
    'not': 'নয়',
    'Not': 'নয়',
    'the ones': 'তারা',
    'anger': 'ক্রোধ',
    'angered': 'ক্রোধান্বিত',
    'who earned': 'যারা অর্জন করেছে',
    'earned': 'অর্জন করেছে',
    'Your anger': 'আপনার ক্রোধ',
    'wrath': 'গজব',
    'astray': 'পথভ্রষ্ট',
    'gone astray': 'পথভ্রষ্ট হয়েছে',
    'go astray': 'পথভ্রষ্ট হওয়া',
    'those': 'তারা/যারা',
    'nor': 'না',
    'and not': 'এবং না',

    // === DAY OF JUDGMENT ===
    'Day': 'দিন',
    'day': 'দিন',
    'the Day': 'সেই দিন',
    'Judgment': 'বিচার',
    'judgment': 'বিচার',
    '(of) the Judgment': 'বিচারের',
    'of Judgment': 'বিচারের',
    'Recompense': 'প্রতিদান',
    'recompense': 'প্রতিদান',
    'the Recompense': 'প্রতিদান',

    // === SOVEREIGNTY ===
    'Master': 'মালিক',
    'master': 'মালিক',
    'King': 'বাদশাহ',
    'Owner': 'মালিক',
    'Sovereign': 'সার্বভৌম',
    'sovereign': 'সার্বভৌম',

    // === PRONOUNS ===
    'you': 'তুমি/তোমরা',
    'You': 'আপনি',
    'we': 'আমরা',
    'We': 'আমরা',
    'they': 'তারা',
    'They': 'তারা',
    'he': 'সে',
    'He': 'তিনি',
    'she': 'সে',
    'She': 'সে',
    'it': 'এটা',
    'It': 'এটা',
    'I': 'আমি',
    'us': 'আমাদের',
    'your': 'তোমার',
    'Your': 'আপনার',
    'our': 'আমাদের',
    'Our': 'আমাদের',
    'their': 'তাদের',
    'Their': 'তাদের',
    'his': 'তার',
    'His': 'তাঁর',
    'her': 'তার',
    'Her': 'তার',
    'its': 'এর',
    'my': 'আমার',
    'My': 'আমার',

    // === CONNECTORS ===
    'and': 'এবং',
    'And': 'এবং',
    'or': 'অথবা',
    'Or': 'অথবা',
    'but': 'কিন্তু',
    'But': 'কিন্তু',
    'then': 'তারপর',
    'Then': 'তারপর',
    'so': 'সুতরাং',
    'So': 'সুতরাং',
    'that': 'যে',
    'That': 'সেই',
    'this': 'এই',
    'This': 'এই',
    'which': 'যা',
    'Which': 'যা',
    'who': 'যে',
    'Who': 'কে',
    'what': 'কি',
    'What': 'কি',
    'when': 'যখন',
    'When': 'যখন',
    'where': 'যেখানে',
    'Where': 'কোথায়',
    'how': 'কিভাবে',
    'How': 'কিভাবে',
    'why': 'কেন',
    'Why': 'কেন',
    'if': 'যদি',
    'If': 'যদি',

    // === PREPOSITIONS ===
    'in': 'মধ্যে',
    'In': 'মধ্যে',
    'on': 'উপর',
    'On': 'উপর',
    'at': 'এ',
    'At': 'এ',
    'from': 'থেকে',
    'From': 'থেকে',
    'with': 'সাথে',
    'With': 'সাথে',
    'by': 'দ্বারা',
    'By': 'দ্বারা',
    'about': 'সম্পর্কে',
    'About': 'সম্পর্কে',
    'against': 'বিরুদ্ধে',
    'Against': 'বিরুদ্ধে',
    'between': 'মধ্যে',
    'Between': 'মধ্যে',
    'into': 'মধ্যে',
    'Into': 'মধ্যে',
    'through': 'মাধ্যমে',
    'Through': 'মাধ্যমে',
    'during': 'সময়ে',
    'During': 'সময়ে',
    'before': 'আগে',
    'Before': 'আগে',
    'after': 'পরে',
    'After': 'পরে',
    'above': 'উপরে',
    'Above': 'উপরে',
    'below': 'নিচে',
    'Below': 'নিচে',
    'under': 'অধীনে',
    'Under': 'অধীনে',
    'over': 'উপরে',
    'Over': 'উপরে',

    // === COMMON VERBS ===
    'say': 'বলুন',
    'Say': 'বলুন',
    'said': 'বলেছেন',
    'Said': 'বলেছেন',
    'says': 'বলেন',
    'believe': 'বিশ্বাস করা',
    'Believe': 'বিশ্বাস করুন',
    'believed': 'বিশ্বাস করেছে',
    'believers': 'মুমিনগণ',
    'Believers': 'মুমিনগণ',
    'know': 'জানা',
    'Know': 'জানুন',
    'knew': 'জানত',
    'known': 'পরিচিত',
    'fear': 'ভয় করা',
    'Fear': 'ভয় করুন',
    'feared': 'ভয় করেছে',
    'love': 'ভালোবাসা',
    'Love': 'ভালোবাসুন',
    'loved': 'ভালোবাসত',
    'see': 'দেখা',
    'See': 'দেখুন',
    'saw': 'দেখেছে',
    'seen': 'দেখা হয়েছে',
    'hear': 'শোনা',
    'Hear': 'শুনুন',
    'heard': 'শুনেছে',
    'do': 'করা',
    'Do': 'করুন',
    'did': 'করেছে',
    'done': 'করা হয়েছে',
    'make': 'তৈরি করা',
    'Make': 'তৈরি করুন',
    'made': 'তৈরি করেছে',
    'give': 'দেওয়া',
    'Give': 'দিন',
    'gave': 'দিয়েছে',
    'given': 'দেওয়া হয়েছে',
    'take': 'নেওয়া',
    'Take': 'নিন',
    'took': 'নিয়েছে',
    'taken': 'নেওয়া হয়েছে',
    'come': 'আসা',
    'Come': 'আসুন',
    'came': 'এসেছে',
    'go': 'যাওয়া',
    'Go': 'যান',
    'went': 'গেছে',
    'gone': 'চলে গেছে',
    'send': 'পাঠানো',
    'Send': 'পাঠান',
    'sent': 'পাঠিয়েছে',
    'create': 'সৃষ্টি করা',
    'Create': 'সৃষ্টি করুন',
    'created': 'সৃষ্টি করেছেন',
    'Created': 'সৃষ্টি করেছেন',
    'call': 'ডাকা',
    'Call': 'ডাকুন',
    'called': 'ডেকেছে',
    'follow': 'অনুসরণ করা',
    'Follow': 'অনুসরণ করুন',
    'followed': 'অনুসরণ করেছে',
    'turn': 'ফেরা',
    'Turn': 'ফিরুন',
    'turned': 'ফিরেছে',
    'return': 'ফিরে আসা',
    'Return': 'ফিরে আসুন',
    'returned': 'ফিরে এসেছে',
    'remember': 'স্মরণ করা',
    'Remember': 'স্মরণ করুন',
    'remembered': 'স্মরণ করেছে',
    'forget': 'ভুলে যাওয়া',
    'Forget': 'ভুলে যান',
    'forgot': 'ভুলে গেছে',
    'forgive': 'ক্ষমা করা',
    'Forgive': 'ক্ষমা করুন',
    'forgave': 'ক্ষমা করেছে',
    'forgiven': 'ক্ষমা করা হয়েছে',
    'punish': 'শাস্তি দেওয়া',
    'Punish': 'শাস্তি দিন',
    'punished': 'শাস্তি দিয়েছে',
    'reward': 'পুরস্কার দেওয়া',
    'Reward': 'পুরস্কার',
    'rewarded': 'পুরস্কৃত',
    'enter': 'প্রবেশ করা',
    'Enter': 'প্রবেশ করুন',
    'entered': 'প্রবেশ করেছে',
    'leave': 'ছেড়ে যাওয়া',
    'Leave': 'ছেড়ে যান',
    'left': 'ছেড়ে গেছে',
    'eat': 'খাওয়া',
    'Eat': 'খান',
    'ate': 'খেয়েছে',
    'drink': 'পান করা',
    'Drink': 'পান করুন',
    'drank': 'পান করেছে',
    'sleep': 'ঘুমানো',
    'Sleep': 'ঘুমান',
    'slept': 'ঘুমিয়েছে',
    'die': 'মৃত্যু',
    'Die': 'মরা',
    'died': 'মারা গেছে',
    'dead': 'মৃত',
    'live': 'বাঁচা',
    'Live': 'বাঁচুন',
    'lived': 'বেঁচে ছিল',
    'living': 'জীবিত',

    // === RELIGIOUS TERMS ===
    'heaven': 'জান্নাত',
    'Heaven': 'জান্নাত',
    'heavens': 'আসমানসমূহ',
    'Heavens': 'আসমানসমূহ',
    'the heavens': 'আসমানসমূহ',
    'earth': 'পৃথিবী/জমিন',
    'Earth': 'পৃথিবী',
    'the earth': 'পৃথিবী',
    'sky': 'আকাশ',
    'Sky': 'আকাশ',
    'the sky': 'আকাশ',
    'book': 'কিতাব',
    'Book': 'কিতাব',
    'the Book': 'কিতাব',
    'people': 'মানুষ/জাতি',
    'People': 'মানুষ',
    'the people': 'মানুষেরা',
    'mankind': 'মানবজাতি',
    'Mankind': 'মানবজাতি',
    'human': 'মানুষ',
    'Human': 'মানুষ',
    'soul': 'আত্মা/নফস',
    'Soul': 'আত্মা',
    'souls': 'আত্মাসমূহ',
    'heart': 'অন্তর/হৃদয়',
    'Heart': 'অন্তর',
    'hearts': 'অন্তরসমূহ',
    'messenger': 'রাসূল',
    'Messenger': 'রাসূল',
    'messengers': 'রাসূলগণ',
    'the Messenger': 'রাসূল',
    'prophet': 'নবী',
    'Prophet': 'নবী',
    'prophets': 'নবীগণ',
    'the Prophet': 'নবী',
    'sign': 'নিদর্শন/আয়াত',
    'Sign': 'নিদর্শন',
    'signs': 'নিদর্শনসমূহ',
    'Signs': 'নিদর্শনসমূহ',
    'verse': 'আয়াত',
    'Verse': 'আয়াত',
    'verses': 'আয়াতসমূহ',
    'truth': 'সত্য/হক',
    'Truth': 'সত্য',
    'the truth': 'সত্য',
    'the Truth': 'সত্য',
    'light': 'আলো/নূর',
    'Light': 'আলো',
    'the light': 'আলো',
    'guidance': 'হেদায়েত',
    'Guidance': 'হেদায়েত',
    'the guidance': 'হেদায়েত',
    'mercy': 'রহমত/দয়া',
    'Mercy': 'রহমত',
    'the mercy': 'রহমত',
    'forgiveness': 'ক্ষমা/মাগফিরাত',
    'Forgiveness': 'ক্ষমা',
    'prayer': 'সালাত/নামাজ',
    'Prayer': 'সালাত',
    'the prayer': 'সালাত',
    'prayers': 'সালাতসমূহ',
    'fasting': 'রোজা/সিয়াম',
    'Fasting': 'রোজা',
    'charity': 'দান/যাকাত',
    'Charity': 'দান',
    'pilgrimage': 'হজ্জ',
    'Pilgrimage': 'হজ্জ',
    'righteous': 'সৎকর্মশীল',
    'Righteous': 'সৎকর্মশীল',
    'the righteous': 'সৎকর্মশীলগণ',
    'disbelievers': 'কাফিরগণ',
    'Disbelievers': 'কাফিরগণ',
    'the disbelievers': 'কাফিরগণ',
    'disbelief': 'কুফর',
    'Disbelief': 'কুফর',
    'hypocrites': 'মুনাফিকগণ',
    'Hypocrites': 'মুনাফিকগণ',
    'hypocrisy': 'মুনাফিকি',
    'sin': 'পাপ/গুনাহ',
    'Sin': 'পাপ',
    'sins': 'পাপসমূহ',
    'good': 'ভালো/নেক',
    'Good': 'ভালো',
    'evil': 'মন্দ/খারাপ',
    'Evil': 'মন্দ',
    'right': 'সঠিক/ডান',
    'Right': 'সঠিক',
    'wrong': 'ভুল',
    'Wrong': 'ভুল',
    'punishment': 'শাস্তি/আযাব',
    'Punishment': 'শাস্তি',
    'fire': 'আগুন',
    'Fire': 'আগুন',
    'the Fire': 'জাহান্নাম',
    'hell': 'জাহান্নাম',
    'Hell': 'জাহান্নাম',
    'Hellfire': 'জাহান্নাম',
    'paradise': 'জান্নাত',
    'Paradise': 'জান্নাত',
    'the Paradise': 'জান্নাত',
    'garden': 'বাগান/জান্নাত',
    'Garden': 'বাগান',
    'gardens': 'বাগানসমূহ',
    'Gardens': 'জান্নাতসমূহ',
    'angel': 'ফেরেশতা',
    'Angel': 'ফেরেশতা',
    'angels': 'ফেরেশতাগণ',
    'Angels': 'ফেরেশতাগণ',
    'devil': 'শয়তান',
    'Devil': 'শয়তান',
    'Satan': 'শয়তান',
    'jinn': 'জিন',
    'Jinn': 'জিন',

    // === NUMBERS ===
    'one': 'এক',
    'One': 'এক',
    'two': 'দুই',
    'Two': 'দুই',
    'three': 'তিন',
    'Three': 'তিন',
    'four': 'চার',
    'Four': 'চার',
    'five': 'পাঁচ',
    'Five': 'পাঁচ',
    'six': 'ছয়',
    'Six': 'ছয়',
    'seven': 'সাত',
    'Seven': 'সাত',
    'eight': 'আট',
    'Eight': 'আট',
    'nine': 'নয়',
    'Nine': 'নয়',
    'ten': 'দশ',
    'Ten': 'দশ',
    'hundred': 'শত',
    'Hundred': 'শত',
    'thousand': 'হাজার',
    'Thousand': 'হাজার',
    'first': 'প্রথম',
    'First': 'প্রথম',
    'last': 'শেষ',
    'Last': 'শেষ',
    'all': 'সব',
    'All': 'সব',
    'every': 'প্রতিটি',
    'Every': 'প্রতিটি',
    'each': 'প্রতিটি',
    'Each': 'প্রতিটি',
    'some': 'কিছু',
    'Some': 'কিছু',
    'many': 'অনেক',
    'Many': 'অনেক',
    'few': 'কম',
    'Few': 'কম',
    'most': 'অধিকাংশ',
    'Most': 'সবচেয়ে',
    'more': 'আরো',
    'More': 'আরো',
    'less': 'কম',
    'Less': 'কম',

    // === TIME ===
    'time': 'সময়',
    'Time': 'সময়',
    'night': 'রাত',
    'Night': 'রাত',
    'the night': 'রাত',
    'morning': 'সকাল',
    'Morning': 'সকাল',
    'evening': 'সন্ধ্যা',
    'Evening': 'সন্ধ্যা',
    'hour': 'ঘণ্টা/সময়',
    'Hour': 'কিয়ামত',
    'the Hour': 'কিয়ামত',
    'year': 'বছর',
    'Year': 'বছর',
    'years': 'বছরসমূহ',
    'month': 'মাস',
    'Month': 'মাস',
    'months': 'মাসসমূহ',
    'today': 'আজ',
    'Today': 'আজ',
    'tomorrow': 'আগামীকাল',
    'Tomorrow': 'আগামীকাল',
    'yesterday': 'গতকাল',
    'Yesterday': 'গতকাল',
    'now': 'এখন',
    'Now': 'এখন',
    'always': 'সর্বদা',
    'Always': 'সর্বদা',
    'never': 'কখনো না',
    'Never': 'কখনো না',
    'ever': 'কখনো',
    'Ever': 'কখনো',
    'forever': 'চিরকাল',
    'Forever': 'চিরকাল',
    'eternal': 'চিরস্থায়ী',
    'Eternal': 'চিরস্থায়ী',

    // === MISC COMMON WORDS ===
    'thing': 'জিনিস/বস্তু',
    'Thing': 'জিনিস',
    'things': 'জিনিসসমূহ',
    'something': 'কিছু',
    'Something': 'কিছু',
    'nothing': 'কিছুই না',
    'Nothing': 'কিছুই না',
    'everything': 'সবকিছু',
    'Everything': 'সবকিছু',
    'anything': 'যেকোনো কিছু',
    'Anything': 'যেকোনো কিছু',
    'place': 'স্থান',
    'Place': 'স্থান',
    'water': 'পানি',
    'Water': 'পানি',
    'food': 'খাবার',
    'Food': 'খাবার',
    'life': 'জীবন',
    'Life': 'জীবন',
    'death': 'মৃত্যু',
    'Death': 'মৃত্যু',
    'knowledge': 'জ্ঞান/ইলম',
    'Knowledge': 'জ্ঞান',
    'wisdom': 'হিকমাত/প্রজ্ঞা',
    'Wisdom': 'হিকমাত',
    'power': 'শক্তি/ক্ষমতা',
    'Power': 'শক্তি',
    'glory': 'মহিমা',
    'Glory': 'মহিমা',
    'great': 'মহান/বড়',
    'Great': 'মহান',
    'greatest': 'সর্বশ্রেষ্ঠ',
    'Greatest': 'সর্বশ্রেষ্ঠ',
    'mighty': 'শক্তিশালী',
    'Mighty': 'শক্তিশালী',
    'wise': 'প্রজ্ঞাময়',
    'Wise': 'প্রজ্ঞাময়',
    'knowing': 'জ্ঞানী',
    'Knowing': 'সর্বজ্ঞ',
    'All-Knowing': 'সর্বজ্ঞ',
    'hearing': 'শ্রবণকারী',
    'Hearing': 'শ্রবণকারী',
    'All-Hearing': 'সর্বশ্রোতা',
    'seeing': 'দেখেন',
    'Seeing': 'দ্রষ্টা',
    'All-Seeing': 'সর্বদ্রষ্টা',
    'true': 'সত্য',
    'True': 'সত্য',
    'false': 'মিথ্যা',
    'False': 'মিথ্যা',
    'clear': 'স্পষ্ট',
    'Clear': 'স্পষ্ট',
    'manifest': 'প্রকাশ্য',
    'Manifest': 'প্রকাশ্য',
    'hidden': 'গোপন',
    'Hidden': 'গোপন',
    'secret': 'গোপন',
    'Secret': 'গোপন',
    'open': 'খোলা/প্রকাশ্য',
    'Open': 'খোলা',
    'near': 'নিকটে',
    'Near': 'নিকটে',
    'far': 'দূরে',
    'Far': 'দূরে',
    'high': 'উচ্চ',
    'High': 'উচ্চ',
    'low': 'নিম্ন',
    'Low': 'নিম্ন',
    'big': 'বড়',
    'Big': 'বড়',
    'small': 'ছোট',
    'Small': 'ছোট',
    'old': 'পুরাতন/বৃদ্ধ',
    'Old': 'পুরাতন',
    'new': 'নতুন',
    'New': 'নতুন',
    'young': 'যুবক',
    'Young': 'যুবক',
    'man': 'পুরুষ',
    'Man': 'পুরুষ',
    'men': 'পুরুষেরা',
    'Men': 'পুরুষেরা',
    'woman': 'নারী',
    'Woman': 'নারী',
    'women': 'নারীরা',
    'Women': 'নারীরা',
    'child': 'শিশু',
    'Child': 'শিশু',
    'children': 'শিশুরা/সন্তান',
    'Children': 'শিশুরা',
    'father': 'পিতা',
    'Father': 'পিতা',
    'mother': 'মাতা',
    'Mother': 'মাতা',
    'parents': 'পিতামাতা',
    'Parents': 'পিতামাতা',
    'son': 'পুত্র',
    'Son': 'পুত্র',
    'daughter': 'কন্যা',
    'Daughter': 'কন্যা',
    'brother': 'ভাই',
    'Brother': 'ভাই',
    'sister': 'বোন',
    'Sister': 'বোন',
    'family': 'পরিবার',
    'Family': 'পরিবার',
    'house': 'ঘর',
    'House': 'ঘর',
    'home': 'বাড়ি',
    'Home': 'বাড়ি',
    'city': 'শহর',
    'City': 'শহর',
    'town': 'শহর',
    'Town': 'শহর',
    'village': 'গ্রাম',
    'Village': 'গ্রাম',
    'land': 'ভূমি',
    'Land': 'ভূমি',
    'sea': 'সমুদ্র',
    'Sea': 'সমুদ্র',
    'mountain': 'পাহাড়',
    'Mountain': 'পাহাড়',
    'mountains': 'পাহাড়সমূহ',
    'river': 'নদী',
    'River': 'নদী',
    'rivers': 'নদীসমূহ',
    'tree': 'গাছ',
    'Tree': 'গাছ',
    'trees': 'গাছসমূহ',
    'fruit': 'ফল',
    'Fruit': 'ফল',
    'fruits': 'ফলসমূহ',
  };

  /// Get Bengali translation for an English word
  String? translate(String? englishWord) {
    if (englishWord == null || englishWord.isEmpty) return null;

    // Check cache first
    if (_translationCache.containsKey(englishWord)) {
      return _translationCache[englishWord];
    }

    // Direct match
    if (_dictionary.containsKey(englishWord)) {
      final result = _dictionary[englishWord]!;
      _translationCache[englishWord] = result;
      return result;
    }

    // Try lowercase
    final lower = englishWord.toLowerCase();
    for (final entry in _dictionary.entries) {
      if (entry.key.toLowerCase() == lower) {
        _translationCache[englishWord] = entry.value;
        return entry.value;
      }
    }

    // Try removing parentheses and brackets
    final cleaned = englishWord
        .replaceAll(RegExp(r'[\[\]()]'), '')
        .trim();
    if (_dictionary.containsKey(cleaned)) {
      final result = _dictionary[cleaned]!;
      _translationCache[englishWord] = result;
      return result;
    }

    // Try partial match for compound words
    for (final entry in _dictionary.entries) {
      if (englishWord.toLowerCase().contains(entry.key.toLowerCase()) ||
          entry.key.toLowerCase().contains(englishWord.toLowerCase())) {
        _translationCache[englishWord] = entry.value;
        return entry.value;
      }
    }

    return null;
  }

  /// Translate using Google Translate API (fallback)
  Future<String?> translateOnline(String englishText) async {
    // First try local dictionary
    final localResult = translate(englishText);
    if (localResult != null) return localResult;

    // Try Google Translate (free tier)
    try {
      final url = Uri.parse(
        'https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=bn&dt=t&q=${Uri.encodeComponent(englishText)}',
      );

      final response = await http.get(url);
      if (response.statusCode == 200) {
        final data = json.decode(response.body);
        if (data is List && data.isNotEmpty && data[0] is List) {
          final translations = data[0] as List;
          if (translations.isNotEmpty && translations[0] is List) {
            final result = translations[0][0] as String?;
            if (result != null) {
              _translationCache[englishText] = result;
              return result;
            }
          }
        }
      }
    } catch (e) {
      debugPrint('Online translation error: $e');
    }

    return null;
  }

  /// Clear translation cache
  void clearCache() {
    _translationCache.clear();
  }
}
